<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>My Quizzes â€¢ UniNest</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles/app.css" />
    <script src="scripts/vendor/lucide.js"></script>
    <style>
      .quiz-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--space-5);
        margin-bottom: var(--space-6);
      }

      .stat-card {
        background: var(--color-white);
        border: 2px solid var(--color-border);
        border-radius: var(--radius-xl);
        padding: var(--space-6);
        transition: all 0.3s ease;
      }

      .stat-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
      }

      .stat-card.stat-card--brand {
        background: linear-gradient(
          135deg,
          var(--color-brand) 0%,
          #6d4ef7 100%
        );
        border-color: var(--color-brand);
        color: white;
      }

      .stat-card.stat-card--success {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        border-color: #10b981;
        color: white;
      }

      .stat-card.stat-card--warning {
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        border-color: #f59e0b;
        color: white;
      }

      .stat-card.stat-card--danger {
        background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
        border-color: #ef4444;
        color: white;
      }

      .stat-icon {
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(255, 255, 255, 0.2);
        border-radius: var(--radius-lg);
        margin-bottom: var(--space-4);
      }

      .stat-card:not(.stat-card--brand):not(.stat-card--success):not(
          .stat-card--warning
        ):not(.stat-card--danger)
        .stat-icon {
        background: var(--color-surface);
        color: var(--color-brand);
      }

      .stat-icon i {
        width: 24px;
        height: 24px;
      }

      .stat-value {
        font-size: var(--fs-3xl);
        font-weight: 700;
        margin-bottom: var(--space-2);
        line-height: 1;
      }

      .stat-label {
        font-size: var(--fs-sm);
        opacity: 0.9;
      }

      .filters-bar {
        display: flex;
        align-items: center;
        gap: var(--space-4);
        margin-bottom: var(--space-6);
        padding: var(--space-5);
        background: var(--color-white);
        border: 1px solid var(--color-border);
        border-radius: var(--radius-lg);
      }

      .filter-tabs {
        display: flex;
        gap: var(--space-2);
        flex: 1;
      }

      .filter-tab {
        padding: var(--space-3) var(--space-5);
        border: 1.5px solid var(--color-border);
        background: transparent;
        border-radius: var(--radius-lg);
        font-size: var(--fs-sm);
        font-weight: 600;
        color: var(--color-text-muted);
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .filter-tab:hover {
        background: var(--color-surface);
        color: var(--color-text);
      }

      .filter-tab.is-active {
        background: var(--color-brand);
        border-color: var(--color-brand);
        color: white;
      }

      .quiz-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        gap: var(--space-5);
      }

      .quiz-card {
        background: var(--color-white);
        border: 2px solid var(--color-border);
        border-radius: var(--radius-xl);
        padding: 0;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .quiz-card:hover {
        border-color: var(--color-brand);
        box-shadow: 0 8px 24px rgba(84, 44, 245, 0.12);
        transform: translateY(-4px);
      }

      .quiz-card-header {
        padding: var(--space-6);
        background: linear-gradient(
          135deg,
          var(--color-surface) 0%,
          rgba(84, 44, 245, 0.02) 100%
        );
        border-bottom: 2px solid var(--color-border);
      }

      .quiz-card-title {
        font-size: var(--fs-lg);
        font-weight: 700;
        color: var(--color-text);
        margin: 0 0 var(--space-2) 0;
        line-height: 1.4;
      }

      .quiz-card-meta {
        display: flex;
        align-items: center;
        gap: var(--space-4);
        font-size: var(--fs-sm);
        color: var(--color-text-muted);
      }

      .quiz-card-meta-item {
        display: flex;
        align-items: center;
        gap: var(--space-2);
      }

      .quiz-card-meta-item i {
        width: 16px;
        height: 16px;
      }

      .quiz-card-body {
        padding: var(--space-6);
      }

      .quiz-card-description {
        font-size: var(--fs-sm);
        color: var(--color-text-muted);
        line-height: 1.6;
        margin-bottom: var(--space-5);
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }

      .quiz-card-stats {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-4);
        margin-bottom: var(--space-5);
      }

      .quiz-stat {
        display: flex;
        align-items: center;
        gap: var(--space-2);
        font-size: var(--fs-sm);
      }

      .quiz-stat i {
        width: 18px;
        height: 18px;
        color: var(--color-brand);
      }

      .quiz-stat-value {
        font-weight: 700;
        color: var(--color-text);
      }

      .quiz-card-footer {
        display: flex;
        gap: var(--space-3);
        padding-top: var(--space-5);
        border-top: 1px solid var(--color-border);
      }

      .quiz-status-badge {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-2) var(--space-4);
        border-radius: var(--radius-full);
        font-size: var(--fs-xs);
        font-weight: 600;
        margin-bottom: var(--space-4);
      }

      .quiz-status-badge.status-published {
        background: rgba(16, 185, 129, 0.1);
        color: #10b981;
      }

      .quiz-status-badge.status-pending {
        background: rgba(245, 158, 11, 0.1);
        color: #f59e0b;
      }

      .quiz-status-badge.status-draft {
        background: rgba(107, 114, 128, 0.1);
        color: #6b7280;
      }

      .quiz-status-badge.status-rejected {
        background: rgba(239, 68, 68, 0.1);
        color: #ef4444;
      }

      .quiz-status-badge i {
        width: 12px;
        height: 12px;
      }

      .empty-state {
        text-align: center;
        padding: var(--space-16) var(--space-8);
        background: var(--color-white);
        border: 2px dashed var(--color-border);
        border-radius: var(--radius-xl);
      }

      .empty-state-icon {
        width: 80px;
        height: 80px;
        margin: 0 auto var(--space-5);
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--color-surface);
        border-radius: var(--radius-full);
        color: var(--color-text-muted);
      }

      .empty-state-icon i {
        width: 40px;
        height: 40px;
      }

      .empty-state h3 {
        font-size: var(--fs-xl);
        font-weight: 700;
        color: var(--color-text);
        margin: 0 0 var(--space-3) 0;
      }

      .empty-state p {
        font-size: var(--fs-base);
        color: var(--color-text-muted);
        margin: 0 0 var(--space-6) 0;
      }

      @media (max-width: 768px) {
        .quiz-grid {
          grid-template-columns: 1fr;
        }

        .filters-bar {
          flex-direction: column;
          align-items: stretch;
        }

        .filter-tabs {
          flex-wrap: wrap;
        }
      }
    </style>
  </head>
  <body>
    <button
      type="button"
      class="c-theme-toggle js-theme-toggle"
      aria-pressed="false"
      aria-label="Toggle dark mode"
    >
      <span class="c-theme-toggle__icon" aria-hidden="true">
        <i data-lucide="moon"></i>
      </span>
      <span class="c-theme-toggle__label">Dark</span>
    </button>

    <div class="l-app">
      <aside class="c-sidebar">
        <div class="c-logo">
          <img src="img/logo.png" alt="Uninest" class="c-logo__mark" />
        </div>
        <div class="c-user-mini">
          <div class="c-user-mini__avatar" aria-hidden="true"></div>
          <div class="c-user-mini__meta">
            <span class="c-user-mini__name">Tharindu Fernando</span>
            <span class="c-user-mini__role">Student</span>
          </div>
        </div>
        <nav class="c-nav" aria-label="Main">
          <a href="dashboard.html" class="c-nav__item">
            <span class="c-nav__icon"><i data-lucide="home"></i></span>
            Dashboard
          </a>
          <a href="#" class="c-nav__item">
            <span class="c-nav__icon"><i data-lucide="book"></i></span>
            Subjects
          </a>
          <a href="kuppi-sessions.html" class="c-nav__item">
            <span class="c-nav__icon"
              ><i data-lucide="graduation-cap"></i
            ></span>
            Kuppi Sessions
          </a>
          <a href="resources.html" class="c-nav__item">
            <span class="c-nav__icon"><i data-lucide="file-text"></i></span>
            Resources
          </a>
          <a href="my-quizzes.html" class="c-nav__item is-active">
            <span class="c-nav__icon"
              ><i data-lucide="clipboard-list"></i
            ></span>
            My Quizzes
          </a>
          <a href="community.html" class="c-nav__item">
            <span class="c-nav__icon"
              ><i data-lucide="message-square"></i
            ></span>
            Community
          </a>
          <a href="profile-settings.html" class="c-nav__item">
            <span class="c-nav__icon"><i data-lucide="settings"></i></span>
            Settings
          </a>
        </nav>
        <a href="#" class="c-nav__item c-logout-button">
          <span class="c-nav__icon"><i data-lucide="log-out"></i></span>
          Logout
        </a>
      </aside>

      <main class="c-page">
        <header class="c-page__header">
          <nav class="c-breadcrumbs" aria-label="Breadcrumb">
            <a href="dashboard.html">Home</a>
            <span class="c-breadcrumbs__sep">/</span>
            <span aria-current="page">My Quizzes</span>
          </nav>
          <div
            style="
              display: flex;
              align-items: center;
              justify-content: space-between;
            "
          >
            <div>
              <h1 class="c-page__title">My Quizzes</h1>
              <p class="c-page__subtitle u-text-muted">
                Manage and track all quizzes you've created
              </p>
            </div>
            <a href="create-quiz.html" class="c-btn">
              <i data-lucide="plus"></i>
              Create Quiz
            </a>
          </div>
        </header>

        <!-- Stats -->
        <div class="quiz-stats">
          <div class="stat-card stat-card--brand">
            <div class="stat-icon">
              <i data-lucide="clipboard-list"></i>
            </div>
            <div class="stat-value" id="stat-total">0</div>
            <div class="stat-label">Total Quizzes</div>
          </div>

          <div class="stat-card stat-card--success">
            <div class="stat-icon">
              <i data-lucide="check-circle"></i>
            </div>
            <div class="stat-value" id="stat-published">0</div>
            <div class="stat-label">Published</div>
          </div>

          <div class="stat-card stat-card--warning">
            <div class="stat-icon">
              <i data-lucide="clock"></i>
            </div>
            <div class="stat-value" id="stat-pending">0</div>
            <div class="stat-label">Pending Approval</div>
          </div>

          <div class="stat-card stat-card--danger">
            <div class="stat-icon">
              <i data-lucide="x-circle"></i>
            </div>
            <div class="stat-value" id="stat-rejected">0</div>
            <div class="stat-label">Rejected</div>
          </div>
        </div>

        <!-- Filters -->
        <div class="filters-bar">
          <div class="filter-tabs">
            <button class="filter-tab is-active" onclick="filterQuizzes('all')">
              All
            </button>
            <button class="filter-tab" onclick="filterQuizzes('published')">
              Published
            </button>
            <button class="filter-tab" onclick="filterQuizzes('pending')">
              Pending
            </button>
            <button class="filter-tab" onclick="filterQuizzes('draft')">
              Drafts
            </button>
            <button class="filter-tab" onclick="filterQuizzes('rejected')">
              Rejected
            </button>
          </div>
        </div>

        <!-- Quiz Grid -->
        <div class="quiz-grid" id="quiz-grid">
          <!-- Quizzes will be rendered here -->
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="empty-state" style="display: none">
          <div class="empty-state-icon">
            <i data-lucide="inbox"></i>
          </div>
          <h3>No quizzes found</h3>
          <p>
            You haven't created any quizzes yet. Start creating to help your
            peers learn!
          </p>
          <a href="create-quiz.html" class="c-btn">
            <i data-lucide="plus"></i>
            Create Your First Quiz
          </a>
        </div>
      </main>
    </div>

    <script src="scripts/app.js"></script>
    <script>
      let currentFilter = "all";
      let quizzes = [];

      document.addEventListener("DOMContentLoaded", function () {
        if (window.lucide) window.lucide.createIcons();
        loadQuizzes();
      });

      function loadQuizzes() {
        // Load from localStorage (in real app, would fetch from API)
        const storedQuizzes = JSON.parse(
          localStorage.getItem("quizzes") || "[]"
        );

        // Add some demo data if empty
        if (storedQuizzes.length === 0) {
          quizzes = [
            {
              id: 1,
              title: "Data Structures & Algorithms - Mid-Term Practice",
              description:
                "Comprehensive practice quiz covering trees, graphs, sorting algorithms, and time complexity analysis.",
              subject: "Computer Science",
              duration: 45,
              questions: [{ text: "Sample", options: [] }],
              questionCount: 15,
              status: "published",
              createdAt: new Date(2025, 9, 15).toISOString(),
              attempts: 23,
              avgScore: 78,
            },
            {
              id: 2,
              title: "Object-Oriented Programming Basics",
              description:
                "Test your understanding of OOP principles including encapsulation, inheritance, and polymorphism.",
              subject: "Computer Science",
              duration: 30,
              questions: [{ text: "Sample", options: [] }],
              questionCount: 10,
              status: "pending",
              createdAt: new Date(2025, 9, 20).toISOString(),
              attempts: 0,
              avgScore: 0,
            },
            {
              id: 3,
              title: "Database Design & SQL Queries",
              description:
                "Practice quiz on normalization, ER diagrams, and complex SQL queries.",
              subject: "Computer Science",
              duration: 40,
              questions: [{ text: "Sample", options: [] }],
              questionCount: 12,
              status: "draft",
              createdAt: new Date(2025, 9, 22).toISOString(),
              attempts: 0,
              avgScore: 0,
            },
          ];
        } else {
          quizzes = storedQuizzes.map((q, i) => ({
            ...q,
            id: i + 1,
            questionCount: q.questions?.length || 0,
            attempts: Math.floor(Math.random() * 50),
            avgScore: Math.floor(Math.random() * 40 + 60),
            status: q.status || "pending",
          }));
        }

        updateStats();
        renderQuizzes();
      }

      function updateStats() {
        const stats = {
          total: quizzes.length,
          published: quizzes.filter((q) => q.status === "published").length,
          pending: quizzes.filter((q) => q.status === "pending").length,
          rejected: quizzes.filter((q) => q.status === "rejected").length,
        };

        document.getElementById("stat-total").textContent = stats.total;
        document.getElementById("stat-published").textContent = stats.published;
        document.getElementById("stat-pending").textContent = stats.pending;
        document.getElementById("stat-rejected").textContent = stats.rejected;
      }

      function filterQuizzes(filter) {
        currentFilter = filter;

        // Update active tab
        document.querySelectorAll(".filter-tab").forEach((tab) => {
          tab.classList.remove("is-active");
        });
        event.target.classList.add("is-active");

        renderQuizzes();
      }

      function renderQuizzes() {
        const container = document.getElementById("quiz-grid");
        const emptyState = document.getElementById("empty-state");

        let filteredQuizzes = quizzes;
        if (currentFilter !== "all") {
          filteredQuizzes = quizzes.filter((q) => q.status === currentFilter);
        }

        if (filteredQuizzes.length === 0) {
          container.style.display = "none";
          emptyState.style.display = "block";
          if (window.lucide) window.lucide.createIcons();
          return;
        }

        container.style.display = "grid";
        emptyState.style.display = "none";

        container.innerHTML = filteredQuizzes
          .map(
            (quiz) => `
          <div class="quiz-card">
            <div class="quiz-card-header">
              ${getStatusBadge(quiz.status)}
              <h3 class="quiz-card-title">${quiz.title}</h3>
              <div class="quiz-card-meta">
                <span class="quiz-card-meta-item">
                  <i data-lucide="book-open"></i>
                  ${quiz.subject}
                </span>
                <span class="quiz-card-meta-item">
                  <i data-lucide="clock"></i>
                  ${quiz.duration} min
                </span>
              </div>
            </div>
            
            <div class="quiz-card-body">
              <p class="quiz-card-description">${
                quiz.description || "No description provided"
              }</p>
              
              <div class="quiz-card-stats">
                <div class="quiz-stat">
                  <i data-lucide="help-circle"></i>
                  <span><span class="quiz-stat-value">${
                    quiz.questionCount
                  }</span> Questions</span>
                </div>
                <div class="quiz-stat">
                  <i data-lucide="users"></i>
                  <span><span class="quiz-stat-value">${
                    quiz.attempts
                  }</span> Attempts</span>
                </div>
                <div class="quiz-stat">
                  <i data-lucide="calendar"></i>
                  <span>${formatDate(quiz.createdAt)}</span>
                </div>
                ${
                  quiz.status === "published"
                    ? `
                  <div class="quiz-stat">
                    <i data-lucide="trending-up"></i>
                    <span><span class="quiz-stat-value">${quiz.avgScore}%</span> Avg</span>
                  </div>
                `
                    : "<div></div>"
                }
              </div>

              <div class="quiz-card-footer">
                <button class="c-btn c-btn--sm c-btn--ghost" onclick="viewQuiz(${
                  quiz.id
                })">
                  <i data-lucide="eye"></i>
                  View
                </button>
                ${
                  quiz.status === "draft" || quiz.status === "rejected"
                    ? `
                  <button class="c-btn c-btn--sm c-btn--ghost" onclick="editQuiz(${quiz.id})">
                    <i data-lucide="edit"></i>
                    Edit
                  </button>
                `
                    : ""
                }
                <button class="c-btn c-btn--sm c-btn--ghost" onclick="deleteQuiz(${
                  quiz.id
                })" style="margin-left: auto; color: #ef4444;">
                  <i data-lucide="trash-2"></i>
                  Delete
                </button>
              </div>
            </div>
          </div>
        `
          )
          .join("");

        if (window.lucide) window.lucide.createIcons();
      }

      function getStatusBadge(status) {
        const badges = {
          published:
            '<span class="quiz-status-badge status-published"><i data-lucide="check-circle"></i> Published</span>',
          pending:
            '<span class="quiz-status-badge status-pending"><i data-lucide="clock"></i> Pending Approval</span>',
          draft:
            '<span class="quiz-status-badge status-draft"><i data-lucide="file-text"></i> Draft</span>',
          rejected:
            '<span class="quiz-status-badge status-rejected"><i data-lucide="x-circle"></i> Rejected</span>',
        };
        return badges[status] || "";
      }

      function formatDate(dateString) {
        const date = new Date(dateString);
        const now = new Date();
        const diff = now - date;
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));

        if (days === 0) return "Today";
        if (days === 1) return "Yesterday";
        if (days < 7) return `${days} days ago`;
        if (days < 30) return `${Math.floor(days / 7)} weeks ago`;

        return date.toLocaleDateString("en-US", {
          month: "short",
          day: "numeric",
          year: "numeric",
        });
      }

      function viewQuiz(id) {
        alert(`View quiz ${id} - Feature coming soon!`);
      }

      function editQuiz(id) {
        window.location.href = "create-quiz.html";
      }

      function deleteQuiz(id) {
        if (
          confirm(
            "Are you sure you want to delete this quiz? This action cannot be undone."
          )
        ) {
          quizzes = quizzes.filter((q) => q.id !== id);
          updateStats();
          renderQuizzes();
          showToast("Quiz deleted successfully", "success");
        }
      }

      function showToast(message, type = "success") {
        const toast = document.createElement("div");
        toast.style.cssText = `
          position: fixed;
          bottom: 24px;
          right: 24px;
          background: ${type === "success" ? "#10b981" : "#ef4444"};
          color: white;
          padding: 16px 24px;
          border-radius: 8px;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          z-index: 1000;
          animation: slideIn 0.3s ease;
        `;
        toast.textContent = message;
        document.body.appendChild(toast);

        setTimeout(() => {
          toast.remove();
        }, 3000);
      }
    </script>
  </body>
</html>
